
<h1 class="sectionedit1 heading-combo" id="troubleshooting_orm_returning_null">Troubleshooting ORM returning null</h1>
<div class="level1">

<p>
Sometimes you may get no data back from an ORM query. You&#039;ll see an error like this one below stating that there was no data returned.
</p>
<pre class="file-container-combo file-container-html-combo" data-download-link="true" data-src="file.html">
<code class="language-html file-combo file-html-combo">
/vendor/twig/twig/src/Extension/DebugExtension.php:59:
array (size=0)
  empty</code>
</pre>

<p>
<strong>So how do we resolve this?</strong>
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Troubleshooting ORM returning null&quot;,&quot;hid&quot;:&quot;troubleshooting_orm_returning_null&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:1,&quot;range&quot;:&quot;1-317&quot;} -->
<h2 class="sectionedit2 heading-combo" id="step_1">Step 1</h2>
<div class="level2">

<p>
Check the terminal for errors. You should see the query as in the output below.
</p>
<pre class="file-container-combo" data-download-link="true" data-src="file.txt">
<code class="language-txt file-combo">
src/templates/import/matchimport.twig
[Thu Mar 25 16:25:19 2021] INFO:Adding DBA
[Thu Mar 25 16:25:19 2021] DEBUG:SQL:
select  *
from    match t</code>
</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Step 1&quot;,&quot;hid&quot;:&quot;step_1&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:2,&quot;range&quot;:&quot;318-578&quot;} -->
<h2 class="sectionedit3 heading-combo" id="step_2">Step 2</h2>
<div class="level2">

<p>
If your ORM query returns no data try running the query using a database client like DB-Beaver or PhpMyAdmin.
</p>
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;secid&quot;:4,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_box plugin_wrap">
<p>
“select  *
from    match t”
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;secid&quot;:5,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Step 2&quot;,&quot;hid&quot;:&quot;step_2&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:3,&quot;range&quot;:&quot;579-772&quot;} -->
<h2 class="sectionedit6 heading-combo" id="step_3">Step 3</h2>
<div class="level2">

<p>
Retrace your steps.
</p>

<p>
To get data from an ORM object you need the following files:
</p>

<p>
<strong>Define an ORM Class (Model)</strong>
</p>
<pre class="file-container-combo file-container-php-combo" data-download-link="true" data-src="Match.php" data-download-link-label="Download Match.php">
<code class="language-php file-combo file-php-combo">
// ./src/orm/Match.php
&lt;?php
class Match extends \Tina4\ORM
{
    public $tableName=&quot;match&quot;;
    public $primaryKey=&quot;match_key&quot;; //set for primary key
}</code>
</pre>

<p>
<strong>a Template file (View)</strong>
</p>
<pre class="file-container-combo file-container-php-combo" data-download-link="true" data-src="match.twig" data-download-link-label="Download match.twig">
<code class="language-php file-combo file-php-combo">
&lt;!-- ./src/templates/match.twig --&gt;
  {% set match = Tina4.call(&quot;MatchHelper&quot;,&quot;getMatch&quot;,[request.id]) %}
    {{ dump(match) }}</code>
</pre>

<p>
<strong>Controller</strong>
</p>
<pre class="file-container-combo file-container-php-combo" data-download-link="true" data-src="MatchHelper.php" data-download-link-label="Download MatchHelper.php">
<code class="language-php file-combo file-php-combo">
&lt;?php

class LegacyHelper extends \Tina4\Data 
{
  public function getMatch($id) //no data yet
    {
        $match=(new OldMatch())-&gt;select(&quot;*&quot;,1,0)
                               -&gt;where(&quot;match_key = {$id}&quot;)
                               -&gt;asArray();                        
    return $match;
    }
}</code>
</pre>

<p>
<strong>Route (optional)</strong>
a Route is preferable but Tina4 will read your template file by name in the absence of a route matching your url query. 
</p>

<p>
<a href="http://localhost:8383/match.php" class="urlextern" target="target=_blank" title="http://localhost:8383/match.php" rel="ugc nofollow noopener">http://localhost:8383/match.php</a> should reach your template file if it&#039;s located in the templates directory (not a subdirectory of it).
</p>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Step 3&quot;,&quot;hid&quot;:&quot;step_3&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:6,&quot;range&quot;:&quot;773-1914&quot;} -->
<h2 class="sectionedit7 heading-combo" id="step_4">Step 4</h2>
<div class="level2">

<p>
Consider reserved words. In the case above “match” is a <a class="link-external link-combo" href="https://dev.mysql.com/doc/refman/8.0/en/keywords.html" rel="noopener" target="target=_blank">reseved word in MySQL</a>
</p>
<!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_start&quot;,&quot;secid&quot;:8,&quot;range&quot;:&quot;0-&quot;} --><div class="wrap_center wrap_round wrap_important plugin_wrap">
<p>
Avoid Reserved words. If you inherit a database with tables that have reserved words for names you should change the names of those tables.
</p>
</div><!-- EDIT{&quot;target&quot;:&quot;plugin_wrap_end&quot;,&quot;secid&quot;:9,&quot;range&quot;:&quot;0-&quot;} -->
</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;Step 4&quot;,&quot;hid&quot;:&quot;step_4&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:7,&quot;range&quot;:&quot;1915-2249&quot;} -->
<h3 class="sectionedit10 heading-combo" id="as_a_short_term_workaround">As a short term workaround</h3>
<div class="level3">

<p>
You can use tildes around the table name using the fetch method:
</p>
<pre class="file-container-combo file-container-php-combo" data-download-link="true" data-src="file.php">
<code class="language-php file-combo file-php-combo">
$match=$this-&gt;DBA-&gt;fetch(&quot;select * from `match`&quot;)
                         -&gt;asArray();</code>
</pre>

</div>
<!-- EDIT{&quot;target&quot;:&quot;section&quot;,&quot;name&quot;:&quot;As a short term workaround&quot;,&quot;hid&quot;:&quot;as_a_short_term_workaround&quot;,&quot;codeblockOffset&quot;:0,&quot;secid&quot;:10,&quot;range&quot;:&quot;2250-&quot;} -->